{"ast":null,"code":"import { Action } from './Action';\nimport { intervalProvider } from './intervalProvider';\nimport { arrRemove } from '../util/arrRemove';\nexport class AsyncAction extends Action {\n  constructor(scheduler, work) {\n    super(scheduler, work);\n    this.scheduler = scheduler;\n    this.work = work;\n    this.pending = false;\n  }\n\n  schedule(state, delay = 0) {\n    var _a;\n\n    if (this.closed) {\n      return this;\n    }\n\n    this.state = state;\n    const id = this.id;\n    const scheduler = this.scheduler;\n\n    if (id != null) {\n      this.id = this.recycleAsyncId(scheduler, id, delay);\n    }\n\n    this.pending = true;\n    this.delay = delay;\n    this.id = (_a = this.id) !== null && _a !== void 0 ? _a : this.requestAsyncId(scheduler, this.id, delay);\n    return this;\n  }\n\n  requestAsyncId(scheduler, _id, delay = 0) {\n    return intervalProvider.setInterval(scheduler.flush.bind(scheduler, this), delay);\n  }\n\n  recycleAsyncId(_scheduler, id, delay = 0) {\n    if (delay != null && this.delay === delay && this.pending === false) {\n      return id;\n    }\n\n    if (id != null) {\n      intervalProvider.clearInterval(id);\n    }\n\n    return undefined;\n  }\n\n  execute(state, delay) {\n    if (this.closed) {\n      return new Error('executing a cancelled action');\n    }\n\n    this.pending = false;\n\n    const error = this._execute(state, delay);\n\n    if (error) {\n      return error;\n    } else if (this.pending === false && this.id != null) {\n      this.id = this.recycleAsyncId(this.scheduler, this.id, null);\n    }\n  }\n\n  _execute(state, _delay) {\n    let errored = false;\n    let errorValue;\n\n    try {\n      this.work(state);\n    } catch (e) {\n      errored = true;\n      errorValue = e ? e : new Error('Scheduled action threw falsy error');\n    }\n\n    if (errored) {\n      this.unsubscribe();\n      return errorValue;\n    }\n  }\n\n  unsubscribe() {\n    if (!this.closed) {\n      const {\n        id,\n        scheduler\n      } = this;\n      const {\n        actions\n      } = scheduler;\n      this.work = this.state = this.scheduler = null;\n      this.pending = false;\n      arrRemove(actions, this);\n\n      if (id != null) {\n        this.id = this.recycleAsyncId(scheduler, id, null);\n      }\n\n      this.delay = null;\n      super.unsubscribe();\n    }\n  }\n\n}","map":{"version":3,"sources":["C:/Users/Somji/OneDrive/Pictures/abcd/node_modules/rxjs/dist/esm/internal/scheduler/AsyncAction.js"],"names":["Action","intervalProvider","arrRemove","AsyncAction","constructor","scheduler","work","pending","schedule","state","delay","_a","closed","id","recycleAsyncId","requestAsyncId","_id","setInterval","flush","bind","_scheduler","clearInterval","undefined","execute","Error","error","_execute","_delay","errored","errorValue","e","unsubscribe","actions"],"mappings":"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","sourcesContent":["import { Action } from './Action';\nimport { intervalProvider } from './intervalProvider';\nimport { arrRemove } from '../util/arrRemove';\nexport class AsyncAction extends Action {\n    constructor(scheduler, work) {\n        super(scheduler, work);\n        this.scheduler = scheduler;\n        this.work = work;\n        this.pending = false;\n    }\n    schedule(state, delay = 0) {\n        var _a;\n        if (this.closed) {\n            return this;\n        }\n        this.state = state;\n        const id = this.id;\n        const scheduler = this.scheduler;\n        if (id != null) {\n            this.id = this.recycleAsyncId(scheduler, id, delay);\n        }\n        this.pending = true;\n        this.delay = delay;\n        this.id = (_a = this.id) !== null && _a !== void 0 ? _a : this.requestAsyncId(scheduler, this.id, delay);\n        return this;\n    }\n    requestAsyncId(scheduler, _id, delay = 0) {\n        return intervalProvider.setInterval(scheduler.flush.bind(scheduler, this), delay);\n    }\n    recycleAsyncId(_scheduler, id, delay = 0) {\n        if (delay != null && this.delay === delay && this.pending === false) {\n            return id;\n        }\n        if (id != null) {\n            intervalProvider.clearInterval(id);\n        }\n        return undefined;\n    }\n    execute(state, delay) {\n        if (this.closed) {\n            return new Error('executing a cancelled action');\n        }\n        this.pending = false;\n        const error = this._execute(state, delay);\n        if (error) {\n            return error;\n        }\n        else if (this.pending === false && this.id != null) {\n            this.id = this.recycleAsyncId(this.scheduler, this.id, null);\n        }\n    }\n    _execute(state, _delay) {\n        let errored = false;\n        let errorValue;\n        try {\n            this.work(state);\n        }\n        catch (e) {\n            errored = true;\n            errorValue = e ? e : new Error('Scheduled action threw falsy error');\n        }\n        if (errored) {\n            this.unsubscribe();\n            return errorValue;\n        }\n    }\n    unsubscribe() {\n        if (!this.closed) {\n            const { id, scheduler } = this;\n            const { actions } = scheduler;\n            this.work = this.state = this.scheduler = null;\n            this.pending = false;\n            arrRemove(actions, this);\n            if (id != null) {\n                this.id = this.recycleAsyncId(scheduler, id, null);\n            }\n            this.delay = null;\n            super.unsubscribe();\n        }\n    }\n}\n"]},"metadata":{},"sourceType":"module"}